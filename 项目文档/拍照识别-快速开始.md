# æ‹ç…§è¯†åˆ«é¢˜ç›®åŠŸèƒ½ - å¿«é€Ÿå¼€å§‹æŒ‡å—

## ğŸ¯ ç›®æ ‡

å®ç°ï¼š**æ‹ç…§ä¸Šä¼  â†’ OCRè¯†åˆ« â†’ AIè§£è¯»**

---

## âš¡ æœ€ç®€æ–¹æ¡ˆï¼ˆ15åˆ†é’Ÿå®ç°ï¼‰

### ç¬¬ä¸€æ­¥ï¼šå®‰è£…ä¾èµ–

```bash
npm install tesseract.js
```

### ç¬¬äºŒæ­¥ï¼šåˆ›å»ºOCRæœåŠ¡

åˆ›å»º `src/lib/services/ocr.ts`ï¼š

```typescript
import { createWorker } from 'tesseract.js';

export async function recognizeText(imageFile: File): Promise<string> {
  const worker = await createWorker('chi_sim+eng'); // ä¸­è‹±æ–‡è¯†åˆ«
  const { data: { text } } = await worker.recognize(imageFile);
  await worker.terminate();
  return text.trim();
}
```

### ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºOCR API

åˆ›å»º `src/app/api/ocr/recognize/route.ts`ï¼š

```typescript
import { NextResponse } from 'next/server';
import { recognizeText } from '@/lib/services/ocr';

export async function POST(req: Request) {
  try {
    const formData = await req.formData();
    const imageFile = formData.get('image') as File;
    
    if (!imageFile) {
      return NextResponse.json(
        { error: 'No image provided' },
        { status: 400 }
      );
    }
    
    const text = await recognizeText(imageFile);
    
    return NextResponse.json({ text });
  } catch (error) {
    console.error('OCR error:', error);
    return NextResponse.json(
      { error: 'OCR recognition failed' },
      { status: 500 }
    );
  }
}
```

### ç¬¬å››æ­¥ï¼šæ‰©å±•æ–‡ä»¶ä¸Šä¼ 

ä¿®æ”¹ `src/components/MessageInputActions/Attach.tsx`ï¼š

åœ¨ `accept` å±æ€§ä¸­æ·»åŠ å›¾ç‰‡æ ¼å¼ï¼š
```typescript
accept=".pdf,.docx,.txt,.jpg,.jpeg,.png"
```

### ç¬¬äº”æ­¥ï¼šå›¾ç‰‡è¯†åˆ«æµç¨‹

ä¿®æ”¹èŠå¤©ç»„ä»¶ï¼Œæ”¯æŒå›¾ç‰‡è¯†åˆ«ï¼š

1. æ£€æµ‹ä¸Šä¼ çš„æ˜¯å›¾ç‰‡
2. è°ƒç”¨ `/api/ocr/recognize` è¯†åˆ«
3. å°†è¯†åˆ«ç»“æœä½œä¸ºé—®é¢˜å‘é€

---

## ğŸ¨ å®Œæ•´æ–¹æ¡ˆï¼ˆæ¨èï¼‰

### OCRæœåŠ¡é€‰æ‹©å¯¹æ¯”

| æœåŠ¡ | ä¼˜ç‚¹ | ç¼ºç‚¹ | æ¨èåº¦ |
|------|------|------|--------|
| **Tesseract.js** | å…è´¹ã€æœ¬åœ°è¯†åˆ« | å‡†ç¡®åº¦è¾ƒä½ | â­â­â­ æµ‹è¯•ç”¨ |
| **ç™¾åº¦OCR** | å›½å†…å¿«ã€ä¸­æ–‡å¥½ã€æ”¯æŒå…¬å¼ | éœ€è¦APIå¯†é’¥ | â­â­â­â­â­ |
| **Google Vision** | è¯†åˆ«å‡†ç¡® | éœ€è¦ç§‘å­¦ä¸Šç½‘ | â­â­â­â­ |

### æ¨èé…ç½®

**æµ‹è¯•é˜¶æ®µ**ï¼šTesseract.jsï¼ˆå…è´¹ï¼Œå¿«é€ŸéªŒè¯åŠŸèƒ½ï¼‰

**ç”Ÿäº§ç¯å¢ƒ**ï¼šç™¾åº¦OCRï¼ˆå‡†ç¡®åº¦é«˜ï¼Œæ”¯æŒæ•°å­¦å…¬å¼ï¼‰

---

## ğŸ“ å®æ–½æ­¥éª¤æ¸…å•

### é˜¶æ®µ1ï¼šåŸºç¡€åŠŸèƒ½ï¼ˆ1-2å°æ—¶ï¼‰
- [ ] å®‰è£… OCR åº“
- [ ] åˆ›å»º OCR æœåŠ¡å°è£…
- [ ] åˆ›å»º OCR API è·¯ç”±
- [ ] æ‰©å±•æ–‡ä»¶ä¸Šä¼ æ”¯æŒå›¾ç‰‡
- [ ] æ·»åŠ å›¾ç‰‡é¢„è§ˆ
- [ ] é›†æˆè¯†åˆ«æµç¨‹åˆ°èŠå¤©

### é˜¶æ®µ2ï¼šä¼˜åŒ–ä½“éªŒï¼ˆ2-3å°æ—¶ï¼‰
- [ ] æ·»åŠ è¯†åˆ«è¿›åº¦æ˜¾ç¤º
- [ ] è¯†åˆ«ç»“æœå¯ç¼–è¾‘
- [ ] é”™è¯¯å¤„ç†å’Œæç¤º
- [ ] å›¾ç‰‡è£å‰ªå’Œè°ƒæ•´

### é˜¶æ®µ3ï¼šå¢å¼ºåŠŸèƒ½ï¼ˆå¯é€‰ï¼‰
- [ ] åˆ‡æ¢åˆ°ä»˜è´¹OCRï¼ˆæé«˜å‡†ç¡®åº¦ï¼‰
- [ ] æ•°å­¦å…¬å¼è¯†åˆ«
- [ ] æ‰¹é‡è¯†åˆ«
- [ ] è¯†åˆ«å†å²

---

## ğŸ”§ å…³é”®æŠ€æœ¯ç‚¹

### 1. å›¾ç‰‡ä¸Šä¼ å¤„ç†
```typescript
// å‰ç«¯ï¼šFormDataä¸Šä¼ 
const formData = new FormData();
formData.append('image', imageFile);

// åç«¯ï¼šæ¥æ”¶Fileå¯¹è±¡
const imageFile = formData.get('image') as File;
```

### 2. OCRè¯†åˆ«
```typescript
// Tesseract.jsï¼ˆæœ¬åœ°ï¼‰
const worker = await createWorker('chi_sim+eng');
const { text } = await worker.recognize(imageFile);

// ç™¾åº¦OCRï¼ˆéœ€è¦APIå¯†é’¥ï¼‰
// å‚è€ƒï¼šhttps://cloud.baidu.com/product/ocr
```

### 3. è¯†åˆ«ç»“æœå¤„ç†
```typescript
// åå¤„ç†ï¼šå»é™¤å¤šä½™ç©ºæ ¼ã€æ¢è¡Œ
const cleanedText = text
  .replace(/\s+/g, ' ')
  .trim();
```

### 4. é›†æˆåˆ°èŠå¤©
```typescript
// è¯†åˆ«åè‡ªåŠ¨å‘é€
const recognizedText = await recognizeOCR(imageFile);
// å°†recognizedTextä½œä¸ºé—®é¢˜å‘é€ç»™AI
```

---

## ğŸš¨ å¸¸è§é—®é¢˜

### Q1: è¯†åˆ«å‡†ç¡®åº¦ä¸é«˜ï¼Ÿ
- **A**: å…ˆç”¨Tesseract.jsæµ‹è¯•æµç¨‹ï¼Œç„¶ååˆ‡æ¢åˆ°ç™¾åº¦OCRæé«˜å‡†ç¡®åº¦

### Q2: è¯†åˆ«æ•°å­¦å…¬å¼ï¼Ÿ
- **A**: ä½¿ç”¨ç™¾åº¦OCRæˆ–MathPix APIä¸“é—¨è¯†åˆ«æ•°å­¦å…¬å¼

### Q3: è¯†åˆ«é€Ÿåº¦æ…¢ï¼Ÿ
- **A**: Tesseract.jsæœ¬åœ°è¯†åˆ«è¾ƒæ…¢ï¼Œåˆ‡æ¢åˆ°äº‘ç«¯OCRä¼šå¿«å¾ˆå¤š

### Q4: å¦‚ä½•æ”¯æŒæ‰‹å†™è¯†åˆ«ï¼Ÿ
- **A**: ç™¾åº¦OCRå’ŒGoogle Visionéƒ½æ”¯æŒæ‰‹å†™è¯†åˆ«ï¼Œéœ€è¦åœ¨APIä¸­æŒ‡å®š

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

- [å®Œæ•´å®ç°æ–¹æ¡ˆ](./æ‹ç…§è¯†åˆ«é¢˜ç›®åŠŸèƒ½å®ç°æ–¹æ¡ˆ.md) - è¯¦ç»†è®¾è®¡æ–‡æ¡£
- [Tesseract.jsæ–‡æ¡£](https://tesseract.projectnaptha.com/)
- [ç™¾åº¦OCRæ–‡æ¡£](https://cloud.baidu.com/product/ocr)

---

## ğŸ’¡ ä¸‹ä¸€æ­¥

1. **å…ˆå®ç°MVP**ï¼šç”¨Tesseract.jså¿«é€ŸéªŒè¯åŠŸèƒ½
2. **æµ‹è¯•ç”¨æˆ·ä½“éªŒ**ï¼šçœ‹çœ‹è¯†åˆ«æµç¨‹æ˜¯å¦é¡ºç•…
3. **ä¼˜åŒ–è¯†åˆ«**ï¼šåˆ‡æ¢åˆ°ä»˜è´¹OCRæé«˜å‡†ç¡®åº¦
4. **å¢å¼ºåŠŸèƒ½**ï¼šæ·»åŠ å…¬å¼è¯†åˆ«ã€æ‰¹é‡è¯†åˆ«ç­‰

**å»ºè®®**ï¼šå…ˆå¿«é€Ÿå®ç°åŸºç¡€åŠŸèƒ½ï¼ŒéªŒè¯ç”¨æˆ·éœ€æ±‚ï¼Œå†é€æ­¥ä¼˜åŒ–ï¼

